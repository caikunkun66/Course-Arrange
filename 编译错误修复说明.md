# 编译错误修复说明

## 问题概述
在简化学生表后，StudentController.java 中仍然使用了已删除字段的 setter 方法，导致编译失败。

## 错误列表
共7个编译错误：
1. setClassNo() - 第51行
2. setStudentNo() - 第101行
3. setRealname() - 第104行
4. setGrade() - 第105行
5. setAddress() - 第106行
6. setTelephone() - 第107行
7. setEmail() - 第108行

## 修复内容

### 1. StudentController.java

#### 修复1：joinClass() 方法（已废弃）
**之前：**
```java
@PostMapping("/join/{id}/{classNo}")
public ServerResponse joinClass(@PathVariable("id") Integer id, 
                                @PathVariable("classNo") String classNo) {
    Student student = studentService.getById(id);
    student.setClassNo(classNo);  // ❌ 编译错误
    ...
}
```

**修复后：**
```java
@Deprecated
@PostMapping("/join/{id}/{teacherId}")
public ServerResponse joinTeacher(@PathVariable("id") Integer id, 
                                  @PathVariable("teacherId") Integer teacherId) {
    Student student = studentService.getById(id);
    if (student == null) {
        return ServerResponse.ofError("学生不存在");
    }
    student.setTeacherId(teacherId);  // ✅ 改为设置教师ID
    ...
}
```

#### 修复2：studentRegister() 方法
**之前：**
```java
@PostMapping("/register")
public ServerResponse studentRegister(@RequestBody StudentRegisterRequest stu) {
    Student student = new Student();
    student.setStudentNo(stu.getStudentNo());    // ❌ 编译错误
    student.setUsername(stu.getUsername());
    student.setPassword(stu.getPassword());
    student.setRealname(stu.getRealname());      // ❌ 编译错误
    student.setGrade(stu.getGrade());            // ❌ 编译错误
    student.setAddress(stu.getAddress());        // ❌ 编译错误
    student.setTelephone(stu.getTelephone());    // ❌ 编译错误
    student.setEmail(stu.getEmail());            // ❌ 编译错误
    ...
}
```

**修复后：**
```java
@PostMapping("/register")
public ServerResponse studentRegister(@RequestBody StudentRegisterRequest stu) {
    // 检查昵称是否已存在
    QueryWrapper<Student> wrapper = new QueryWrapper<Student>().eq("username", stu.getUsername());
    Student existStudent = studentService.getOne(wrapper);
    if (existStudent != null) {
        return ServerResponse.ofError("昵称已存在，请更换昵称");
    }
    
    Student student = new Student();
    student.setUsername(stu.getUsername());  // ✅ 只设置昵称
    student.setPassword(stu.getPassword());  // ✅ 只设置密码
    student.setUserType(3);                  // ✅ 设置用户类型
    ...
}
```

### 2. StudentRegisterRequest.java

#### 简化请求类
**之前：**
```java
@Data
public class StudentRegisterRequest {
    private String studentNo;
    private String username;
    private String password;
    private String realname;
    private String grade;
    private String address;
    private String telephone;
    private String email;
}
```

**修复后：**
```java
@Data
public class StudentRegisterRequest {
    /**
     * 昵称，用于登录
     */
    private String username;

    /**
     * 密码
     */
    private String password;
}
```

### 3. Register.vue（注册页面）

#### 简化注册表单
**之前：** 包含学号、姓名、年级、电话、邮件、地址等11个字段

**修复后：** 只包含3个字段
- 昵称（username）
- 密码（password）
- 确认密码（password2）

#### 主要变更
1. **删除表单字段：**
   - ❌ 真实姓名
   - ❌ 年级选择
   - ❌ 学号生成
   - ❌ 联系电话
   - ❌ 电子邮件
   - ❌ 家庭住址

2. **删除方法：**
   - ❌ createStuNo() - 生成学号方法
   - ❌ handleSelectChange() - 年级选择处理

3. **简化数据对象：**
```javascript
// 之前
studentRegForm: {
    studentNo: '',
    username: '',
    password: '',
    password2: '',
    realname: '',
    telephone: '',
    address: '',
    email: '',
    options: [...],
    grade: '',
    gradeName: ''
}

// 修复后
studentRegForm: {
    username: '',
    password: '',
    password2: ''
}
```

4. **简化注册请求：**
```javascript
// 之前
this.$axios.post('/student/register', {
    username: this.studentRegForm.username,
    password: this.studentRegForm.password,
    realname: this.studentRegForm.realname,
    grade: this.studentRegForm.gradeName,
    studentNo: this.studentRegForm.studentNo,
    telephone: this.studentRegForm.telephone,
    address: this.studentRegForm.address,
    email: this.studentRegForm.email
})

// 修复后
this.$axios.post('/student/register', {
    username: this.studentRegForm.username,
    password: this.studentRegForm.password
})
```

5. **调整样式：**
   - 注册框宽度：550px → 450px
   - 注册框高度：605px → 380px
   - 删除不需要的样式类（.ele, .studentNo-input, .select-grade）

## 验证步骤

### 1. 编译后端
```bash
cd D:\OtherProject\CourseArragement
mvn clean compile
```

预期结果：✅ BUILD SUCCESS

### 2. 运行后端
```bash
mvn spring-boot:run
```

预期结果：✅ 应用启动成功，无编译错误

### 3. 测试学生注册
1. 访问注册页面
2. 填写昵称和密码
3. 点击注册按钮
4. 验证注册成功

### 4. 测试学生登录
1. 使用昵称和密码登录
2. 验证登录成功

## 总结

### 已修复的文件
1. ✅ **StudentController.java** - 修复了7处编译错误
2. ✅ **StudentRegisterRequest.java** - 简化请求类
3. ✅ **Register.vue** - 简化注册表单

### 修复原则
- 删除所有对已删除字段的引用
- 只保留核心字段（昵称、密码）
- 简化注册流程
- 保持代码一致性

### 注意事项
1. **学生注册** - 现在只需要昵称和密码
2. **昵称唯一性** - 系统会检查昵称是否已存在
3. **登录方式** - 使用昵称登录，不再使用学号
4. **用户体验** - 注册流程更简单快捷

## 下一步
现在可以：
1. 重新编译项目：`mvn clean package`
2. 启动后端服务
3. 启动前端服务
4. 测试完整的注册和登录流程

